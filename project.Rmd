---
title: "Memory analysis"
output: html_notebook
---
# Libraries
```{r include=FALSE}
library(tidyr)
library(readr)
library(ggplot2)
library(dplyr)
library(mongolite)
```
# Questions
- What is the average response time by gender and by age ?
- What is the  average moves require to open the 12 pairs of cards?
- There is a relationship between age or gender that determinate the average time to open all cards?
- There is a pattern in the order of open card ?
- There is a improvement in the  persosn how play the game many time?

# Reading data
```{r}
urldb='mongodb+srv://admin:AvrilFG123@mystore.96rrl.mongodb.net/game-memory?retryWrites=true&w=majority'
connectionGames = mongo(collection="games", url=urldb)
connectionUsers = mongo(collection="users", url=urldb)
connectionMoves = mongo(collection="moves", url=urldb)

games <- conectionGames$find('{}')%>%as_tibble()
user <- connectionUsers$find('{}')%>%as_tibble()
moves <- connectionMoves$find('{}')%>%as_tibble()


#moves = read_csv("./moves")
#user = read_csv("./users")
#games = read_csv("./games")
```

```{r}
separatelist <- function(df,column, names){
  return(
    df%>%unnest(column)%>%group_by(id) %>% 
       mutate(col=names) %>% #add a column indicator
       spread(key=col, value=card1)
  )
}
```



```{r}
x <- do.call(rbind, moves$card1)
colnames(c)
cbind(moves,x)
 full_table<-moves %>% mutate(id = 1:nrow(moves)) %>% 

  mutate(card_1=strToIntList(card1), card_2=strToIntList(card2)) %>%
  inner_join(games, by=c("game"="_id"))%>%
  inner_join(user,by=c("user"="_id"))
?separate

```


```{r}
full_table%>%group_by(user)%>%
  summarise(count = n()) %>% 
  arrange(-count)
```

